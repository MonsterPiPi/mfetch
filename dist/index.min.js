!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.Mfetch=e.Mfetch||{})}(this,function(e){"use strict";function n(e){return e&&e.__esModule?e.default:e}function t(e,n){return n={exports:{}},e(n,n.exports),n.exports}function r(e){return U.call(e).slice(8,-1)}function i(e){var n=e.map(function(e){return"["+e+"]"});return n[0]=e[0],n.join("")}function o(e){if(!x(e))throw new TypeError("Argument must be object");var n=new I,t=new m(e),o=function(e,t,r){var o=i(e);S(r)?n.append(o,t):n.append(o,t,r)};t.onStepInto=function(e){e.parent;switch(r(e.node)){case"Array":return!0;case"Object":return!0;case"FileList":return!0;default:return!1}};for(var u=0,c=t;u<c.length;u+=1){var a=c[u],s=a.node,f=a.path;switch(r(s)){case"Array":break;case"Object":break;case"FileList":break;case"File":o(f,s);break;case"Blob":o(f,s,s.name);break;default:o(f,s)}}return n}function u(e){for(var n={},t=0,r=e.keys();t<r.length;t+=1){var i=r[t];n.hasOwnProperty(i)?n[i]=e.getAll(i):n[i]=e.get(i)}return n}function c(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function a(e){switch(e.arrayFormat){case"index":return function(n,t,r){return null===t?[f(n,e),"[",r,"]"].join(""):[f(n,e),"[",f(r,e),"]=",f(t,e)].join("")};case"bracket":return function(n,t){return null===t?f(n,e):[f(n,e),"[]=",f(t,e)].join("")};default:return function(n,t){return null===t?f(n,e):[f(n,e),"=",f(t,e)].join("")}}}function s(e){var n;switch(e.arrayFormat){case"index":return function(e,t,r){if(n=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!n)return void(r[e]=t);void 0===r[e]&&(r[e]={}),r[e][n[1]]=t};case"bracket":return function(e,t,r){if(n=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),!n||void 0===r[e])return void(r[e]=t);r[e]=[].concat(r[e],t)};default:return function(e,n,t){if(void 0===t[e])return void(t[e]=n);t[e]=[].concat(t[e],n)}}}function f(e,n){return n.encode?n.strict?Q(e):encodeURIComponent(e):e}function l(e){return Array.isArray(e)?e.sort():"object"==typeof e?l(Object.keys(e)).sort(function(e,n){return Number(e)-Number(n)}).map(function(n){return e[n]}):e}var p="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},d=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=n.isType=function(e){return function(n){return null!=n&&Object.prototype.toString.call(n)==="[object "+e+"]"}},r=(n.isFn=t("Function"),n.isArr=Array.isArray||t("Array")),i=n.isObj=t("Object");n.isStr=t("String"),n.isNum=t("Number"),n.isIter=function(e){return r(e)||i(e)}});n(d);var h=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.lowerCase=n.compose=n.reduce=n.each=n.extend=n.isValidThen=n.isValid=n.hasOwn=n.hasOwnProperty=n.obj=n.getStr=n.getFn=n.noop=void 0;var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=d,i=n.noop=function(e){return function(){return e}},o=n.getFn=function(e,n){return(0,r.isFn)(e)?e:i(n)},u=n.getStr=function(e){return(0,r.isStr)(e)?e:""},c=(n.obj=function(){return Object.create(null)},n.hasOwnProperty=Object.prototype.hasOwnProperty),a=n.hasOwn=function(e,n){return c.call(e,n)},s=n.isValid=function(e){return void 0!==e&&null!==e},f=(n.isValidThen=function(e,n){return s(e)?e:n},n.extend=function(e,n){for(var t in n)e[t]=n[t];return e},n.each=function(e,n){if((0,r.isFn)(n))if((0,r.isArr)(e))for(var t=0,i=e.length;t<i&&n(e[t],t)!==!1;t++);else for(var o in e)if(a(e,o)&&n(e[o],o)===!1)break}),l=n.reduce=function(e,n,i){if((0,r.isFn)(n)){if((0,r.isArr)(e))return e.reduce(n,i);var o=function(){var t=i;return f(e,function(e,r){t=n(t,e,r)}),{v:t}}();return"object"===(void 0===o?"undefined":t(o))?o.v:void 0}};n.compose=function(){for(var e=arguments,n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=e[r];return function(e){for(var n=arguments,r=arguments.length,i=Array(r>1?r-1:0),u=1;u<r;u++)i[u-1]=n[u];return l(t,function(e,n){return o(n).apply(void 0,[e].concat(i))},e)}},n.lowerCase=function(e){return u(e).toLowerCase()}});n(h);var v=d,g=h,b=function(e){function n(n,t,r){return l[n]?function(t){var i=new e(t);return l[n].call(i,t,(0,g.getFn)(r,t))}:function(n){var i=new e(n);return t.call(i,n,(0,g.getFn)(r,n))}}function t(e,r){if((0,v.isObj)(e))(0,g.each)(e,function(e,n){t(n,e)});else{if(e=(0,g.lowerCase)(p[e]?e:p["process"+e]?"process"+e:e),!(0,v.isFn)(r))return;p[e]||b.push(e),p[e]=n(e,r,p[e])}}function r(e){var n=p[e];return delete n[e],n}function i(e,n){(0,v.isStr)(e)&&(0,v.isFn)(n)?(0,g.hasOwn)(l,e)||(l[e]=n):(0,g.each)(e,function(e,n){i(n,e)})}function o(e){return e=(0,g.lowerCase)(e),p[e]||p["process"+e]}function u(e){return h[e]||(h[e]={name:((0,v.isArr)(e)?e:e.split(",")).filter(function(e){return o(e)})},h[e].path=h[e].name.join(",")),h[e]}function c(e,n,t){if((0,v.isStr)(e)){var r=u(e),i=r.name,c=r.path;if(i.length&&(p[c]=p[c]||g.compose.apply(null,i.map(function(e){return o(e)})),(0,v.isFn)(p[c])))return p[c](n)}return(0,g.isValidThen)(t,n)}function a(e,n){if(!(0,g.isValid)(n))return d[e];d[e]=n}function s(e){return(0,g.isValid)(e)&&(0,g.reduce)(b,function(e,n){return c(n,e)},e)}function f(e){(0,v.isArr)(e)?(0,g.each)(e,function(e){return f(e)}):(0,v.isFn)(e)?e(y):t(e)}var l=(0,g.obj)(),p=(0,g.obj)(),d=(0,g.obj)(),h=(0,g.obj)(),b=[];e=(0,g.getFn)(e);var y={guard:i,process:t,remove:r,post:c,extension:f,cache:a,all:s};return e.prototype=(0,g.extend)(e.prototype,y),y},y=t(function(e,n){!function(t,r){"object"==typeof n&&"object"==typeof e?e.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof n?n.RecursiveIterator=r():t.RecursiveIterator=r()}(p,function(){return function(e){function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){var r=function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)},i=function(e,n,t){n&&Object.defineProperties(e,n),t&&Object.defineProperties(e.prototype,t)},o=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},u=t(1),c=u.isObject,a=u.getKeys,s="__bypassMode",f="__ignoreCircular",l="__maxDeep",p="__cache",d="__queue",h="__state",v={},g=function(){function e(n){var t=void 0===arguments[1]?0:arguments[1],r=void 0!==arguments[2]&&arguments[2],i=void 0===arguments[3]?100:arguments[3];o(this,e),this[s]=t,this[f]=r,this[l]=i,this[p]=[],this[d]=[],this[h]=this.getState(void 0,n),this.__makeIterable()}return i(e,null,{next:{value:function(){var e=this[h]||v,n=e.node,t=e.path,i=e.deep;if(this[l]>i&&this.isNode(n))if(this.isCircular(n)){if(!this[f])throw new Error("Circular reference")}else if(this.onStepInto(this[h])){var o,u=this.getStatesOfChildNodes(n,t,i),c=this[s]?"push":"unshift";(o=this[d])[c].apply(o,r(u)),this[p].push(n)}var a=this[d].shift(),g=!a;return this[h]=a,g&&this.destroy(),{value:a,done:g}},writable:!0,configurable:!0},destroy:{value:function(){this[d].length=0,this[p].length=0,this[h]=null},writable:!0,configurable:!0},isNode:{value:function(e){return c(e)},writable:!0,configurable:!0},isLeaf:{value:function(e){return!this.isNode(e)},writable:!0,configurable:!0},isCircular:{value:function(e){return this[p].indexOf(e)!==-1},writable:!0,configurable:!0},getStatesOfChildNodes:{value:function(e,n,t){var r=this;return a(e).map(function(i){return r.getState(e,e[i],i,n.concat(i),t+1)})},writable:!0,configurable:!0},getState:{value:function(e,n,t){return{parent:e,node:n,key:t,path:void 0===arguments[3]?[]:arguments[3],deep:void 0===arguments[4]?0:arguments[4]}},writable:!0,configurable:!0},onStepInto:{value:function(e){return!0},writable:!0,configurable:!0},__makeIterable:{value:function(){var e=this;try{this[Symbol.iterator]=function(){return e}}catch(e){}},writable:!0,configurable:!0}}),e}();e.exports=g},function(e,n){function t(e){return null!==e&&"object"==typeof e}function r(e){if(!t(e))return!1;if(!("length"in e))return!1;var n=e.length;if(!i(n))return!1;if(n>0)return n-1 in e;for(var r in e)return!1}function i(e){return"number"==typeof e}function o(e){var n=Object.keys(e);if(u(e));else if(r(e)){var t=n.indexOf("length");t>-1&&n.splice(t,1)}else n=n.sort();return n}n.isObject=t,n.isArrayLike=r,n.isNumber=i,n.getKeys=o;var u=n.isArray=Array.isArray;Object.defineProperty(n,"__esModule",{value:!0})}])})}),m=n(y),j=function(e){return function(n){return Object.prototype.toString.call(n)==="[object "+e+"]"}},O=j("Function"),w=Array.isArray||j("Array"),x=j("Object"),A=j("String"),C=j("FormData"),S=j("Undefined"),_=j("Number"),k=function(e){return String(e).toLocaleLowerCase()},F=function(e){return k(e.method)},I=window.FormData,N=Object.prototype,U=N.toString,P=function(e){return k(String(e)).replace(/\s+/gi,"")},R=function(e,n){if(!e)return!1;var t=e.headers;return!(!t||!t["content-type"])&&(n=P(w(n)?n.join("/"):A(n)?n:""),t["content-type"].indexOf(n)>-1)},E=function(e,n){return e=Object.keys(e||{}).reduce(function(n,t){return n[P(t)]=P(e[t]),n},{}),Object.keys(n||{}).forEach(function(t){e[P(t)]=P(n[t])}),e},T=function(e,n,t){return Promise.resolve(n(e)).then(function(e){return t(e)})},q={processFetch:function(e,n){return e=n(e),fetch(e.url,e)},processRequest:function(e,n){var t=this;return T(e,n,function(e){if(_(e.timeout)){var n=e.timeout;return delete e.timeout,t.post("response",new Promise(function(r,i){setTimeout(function(){i(new Error('[mfetch Error] request "'+e.url+'" is timeout!'))},n),t.post("fetch",e).then(r,i)}))}return t.post("response",t.post("fetch",e))})}},M={request:function(e){return{processOption:function(n,t){return T(n,t,function(n){return O(e)?e(n):n})}}},response:function(e){return{processResponse:function(n,t){return T(n,t,function(n){return O(e)?e(n):n})}}}},L=function(e){return Object.keys(e||{}).reduce(function(n,t){return M[t]&&O(e[t])?n.concat(M[t](e[t].bind(e))):n},[])},V=function(e){return{processOption:function(n,t){switch(n=t(n),F(n)){case"get":case"head":return n;default:return n.body=e,n}}}},B=function(e){return{processOption:function(n,t){return n=t(n),n.headers=E(n.headers,e),n}}},D=t(function(e,n){!function(t,r){if("function"==typeof define&&define.amd)define(["exports","module"],r);else if(void 0!==n&&void 0!==e)r(n,e);else{var i={exports:{}};r(i.exports,i),t.fetchJsonp=i.exports}}(p,function(e,n){function t(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function r(e){try{delete window[e]}catch(n){window[e]=void 0}}function i(e){var n=document.getElementById(e);document.getElementsByTagName("head")[0].removeChild(n)}function o(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=e,c=n.timeout||u.timeout,a=n.jsonpCallback||u.jsonpCallback,s=void 0;return new Promise(function(u,f){var l=n.jsonpCallbackFunction||t(),p=a+"_"+l;window[l]=function(e){u({ok:!0,json:function(){return Promise.resolve(e)}}),s&&clearTimeout(s),i(p),r(l)},o+=o.indexOf("?")===-1?"?":"&";var d=document.createElement("script");d.setAttribute("src",""+o+a+"="+l),d.id=p,document.getElementsByTagName("head")[0].appendChild(d),s=setTimeout(function(){f(new Error("JSONP request to "+e+" timed out")),r(l),i(p)},c)})}var u={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};n.exports=o})}),$=function(e){return{processOption:function(n,t){return n=t(n),n.method=k(e),n},processFetch:function(e,n){return"jsonp"==e.method?D(e.url,e):n(e)}}},z=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},J=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,H=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var n={},t=0;t<10;t++)n["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(n).map(function(e){return n[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,n){for(var t,r,i=arguments,o=c(e),u=1;u<arguments.length;u++){t=Object(i[u]);for(var a in t)K.call(t,a)&&(o[a]=t[a]);if(J){r=J(t);for(var s=0;s<r.length;s++)G.call(t,r[s])&&(o[r[s]]=t[r[s]])}}return o},Q=z,W=H,X=function(e){return e.split("?")[1]||""},Y=function(e,n){n=W({arrayFormat:"none"},n);var t=s(n),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach(function(e){var n=e.replace(/\+/g," ").split("="),i=n.shift(),o=n.length>0?n.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),t(decodeURIComponent(i),o,r)}),Object.keys(r).sort().reduce(function(e,n){var t=r[n];return Boolean(t)&&"object"==typeof t&&!Array.isArray(t)?e[n]=l(t):e[n]=t,e},Object.create(null))):r},Z=function(e,n){n=W({encode:!0,strict:!0,arrayFormat:"none"},n);var t=a(n);return e?Object.keys(e).sort().map(function(r){var i=e[r];if(void 0===i)return"";if(null===i)return f(r,n);if(Array.isArray(i)){var o=[];return i.slice().forEach(function(e){void 0!==e&&o.push(t(r,e,o.length))}),o.join("&")}return f(r,n)+"="+f(i,n)}).filter(function(e){return e.length>0}).join("&"):""},ee={extract:X,parse:Y,stringify:Z},ne=function(e){var n=document.createElement("a");return n.href=e,n},te=function(e){var n=e.query_string;return function(e,t){var r=ne(e);return r.search=n.stringify(t),r.href}},re=function(e){var n=e.query_string;return function(e){return n.parse(n.extract(String(e)))}},ie=function(e){var n=e.query_string,t=e.form_data;return function(e){var r={};return A(e)?n.parse(e):C(e)?t.parse(e):x(e)?e:r}},oe=function(e){var n=e.query_string,t=e.form_data;return function(e,r){var i=function(n){return R(e,n)};return i(["application","json"])?JSON.stringify(r):i(["multipart","formdata"])?t.formify(r):i(["application","x-www-form-urlencoded"])?n.stringify(r):void 0}},ue=function(e,n){return Object.keys(e||{}).reduce(function(t,r){return n.indexOf(r)==-1&&(t[r]=e[r]),t},{})},ce=function(e,n){return Object.keys(e||{}).reduce(function(t,r){return n.indexOf(r)>-1&&(t[r]=e[r]),t},{})},ae=function(e,n){return function(t){for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];return t(e.post("serializer",n)).apply(void 0,r)}},se=function(e){return{processSerializer:function(e){return{query_string:{parse:ee.parse,stringify:ee.stringify,extract:ee.extract},form_data:{parse:u,formify:o}}},processOption:function(n,t){n=t(n);var r=n.uri?n.uri.varNames:[],i=ae(this,n);switch(e=i(ie,e),n.url=n.uri?n.uri.fill(ce(e,r)):n.url,F(n)){case"get":case"jsonp":case"head":var o=Object.assign(i(re,n.url),ue(e,r));return n.url=i(te,n.url,o),n;default:return n.body=i(oe,n,Object.assign(i(ie,n.body),ue(e,r))),n}}}},fe=function(e){return{processOption:function(n,t){return n=t(n),n.timeout=e,n}}},le=function(e){return{processOption:function(n,t){return n=t(n),n.mode=e,n}}},pe=t(function(e){!function(n,t){"function"==typeof define&&define.amd?define("uri-templates",[],t):void 0!==e&&e.exports?e.exports=t():n.UriTemplate=t()}(p,function(){function e(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,function(e){return"%"+e.substring(3)})}function n(e){return e=e.replace(/%../g,""),encodeURIComponent(e)===e}function t(t){var r="";i[t.charAt(0)]&&(r=t.charAt(0),t=t.substring(1));var u="",c="",a=!0,s=!1,f=!1;"+"==r?a=!1:"."==r?(c=".",u="."):"/"==r?(c="/",u="/"):"#"==r?(c="#",a=!1):";"==r?(c=";",u=";",s=!0,f=!0):"?"==r?(c="?",u="&",s=!0):"&"==r&&(c="&",u="&",s=!0);for(var l=[],p=t.split(","),d=[],h={},v=0;v<p.length;v++){var g=p[v],b=null;if(g.indexOf(":")!=-1){var y=g.split(":");g=y[0],b=parseInt(y[1])}for(var m={};o[g.charAt(g.length-1)];)m[g.charAt(g.length-1)]=!0,g=g.substring(0,g.length-1);var j={truncate:b,name:g,suffices:m};d.push(j),h[g]=j,l.push(g)}return{varNames:l,prefix:c,substitution:function(n){for(var t="",r=0,i=0;i<d.length;i++){var o=d[i],l=n(o.name);if(null==l||Array.isArray(l)&&0==l.length||"object"==typeof l&&0==Object.keys(l).length)r++;else if(t+=i==r?c:u||",",Array.isArray(l)){s&&(t+=o.name+"=");for(var p=0;p<l.length;p++)p>0&&(t+=o.suffices["*"]?u||",":",",o.suffices["*"]&&s&&(t+=o.name+"=")),t+=a?encodeURIComponent(l[p]).replace(/!/g,"%21"):e(l[p])}else if("object"==typeof l){s&&!o.suffices["*"]&&(t+=o.name+"=");var h=!0;for(var v in l)h||(t+=o.suffices["*"]?u||",":","),h=!1,t+=a?encodeURIComponent(v).replace(/!/g,"%21"):e(v),t+=o.suffices["*"]?"=":",",t+=a?encodeURIComponent(l[v]).replace(/!/g,"%21"):e(l[v])}else s&&(t+=o.name,f&&""==l||(t+="=")),null!=o.truncate&&(l=l.substring(0,o.truncate)),t+=a?encodeURIComponent(l).replace(/!/g,"%21"):e(l)}return t},unSubstitution:function(e,t,r){if(c&&(e=e.substring(c.length)),1==d.length&&d[0].suffices["*"]){for(var i=d[0],o=i.name,f=i.suffices["*"]?e.split(u||","):[e],l=a&&e.indexOf("=")!=-1,p=1;p<f.length;p++){var e=f[p];l&&e.indexOf("=")==-1&&(f[p-1]+=(u||",")+e,f.splice(p,1),p--)}for(var p=0;p<f.length;p++){var e=f[p];a&&e.indexOf("=")!=-1&&(l=!0);var v=e.split(",");1==v.length?f[p]=v[0]:f[p]=v}if(s||l){for(var g=t[o]||{},b=0;b<f.length;b++){var y=e;if(!s||y){if("string"==typeof f[b]){var e=f[b],m=e.split("=",1)[0],e=e.substring(m.length+1);if(a){if(r&&!n(e))return;e=decodeURIComponent(e)}y=e}else{var e=f[b][0],m=e.split("=",1)[0],e=e.substring(m.length+1);if(a){if(r&&!n(e))return;e=decodeURIComponent(e)}f[b][0]=e,y=f[b]}if(a){if(r&&!n(m))return;m=decodeURIComponent(m)}void 0!==g[m]?Array.isArray(g[m])?g[m].push(y):g[m]=[g[m],y]:g[m]=y}}1==Object.keys(g).length&&void 0!==g[o]?t[o]=g[o]:t[o]=g}else{if(a)for(var b=0;b<f.length;b++){var v=f[b];if(Array.isArray(v))for(var j=0;j<v.length;j++){if(r&&!n(v[j]))return;v[j]=decodeURIComponent(v[j])}else{if(r&&!n(v))return;f[b]=decodeURIComponent(v)}}void 0!==t[o]?Array.isArray(t[o])?t[o]=t[o].concat(f):t[o]=[t[o]].concat(f):1!=f.length||i.suffices["*"]?t[o]=f:t[o]=f[0]}}else{for(var f=1==d.length?[e]:e.split(u||","),O={},p=0;p<f.length;p++){for(var w=0;w<d.length-1&&w<p&&!d[w].suffices["*"];w++);if(w!=p){for(var x=d.length-1;x>0&&d.length-x<f.length-p&&!d[x].suffices["*"];x--);d.length-x!=f.length-p?O[p]=w:O[p]=x}else O[p]=p}for(var p=0;p<f.length;p++){var e=f[p];if(e||!s){var v=e.split(","),l=!1;if(s){var e=v[0],o=e.split("=",1)[0],e=e.substring(o.length+1);v[0]=e;var i=h[o]||d[0]}else var i=d[O[p]],o=i.name;for(var b=0;b<v.length;b++)if(a){if(r&&!n(v[b]))return;v[b]=decodeURIComponent(v[b])}(s||i.suffices["*"])&&void 0!==t[o]?Array.isArray(t[o])?t[o]=t[o].concat(v):t[o]=[t[o]].concat(v):1!=v.length||i.suffices["*"]?t[o]=v:t[o]=v[0]}}}return 1}}}function r(e){if(!(this instanceof r))return new r(e);for(var n=e.split("{"),i=[n.shift()],o=[],u=[],c=[],a=[];n.length>0;){var s=n.shift(),f=s.split("}")[0],l=s.substring(f.length+1),p=t(f);u.push(p.substitution),c.push(p.unSubstitution),o.push(p.prefix),i.push(l),a=a.concat(p.varNames)}this.fill=function(e){if(e&&"function"!=typeof e){var n=e;e=function(e){return n[e]}}for(var t=i[0],r=0;r<u.length;r++){t+=(0,u[r])(e),t+=i[r+1]}return t},this.fromUri=function(e,n){n=n||{};for(var t={},r=0;r<i.length;r++){var u=i[r];if(e.substring(0,u.length)!==u)return;if(e=e.substring(u.length),r>=i.length-1){if(""==e)break;return}var a=o[r];if(!a||e.substring(0,a.length)===a){for(var s=i[r+1],f=r;;){if(f==i.length-2){var l=e.substring(e.length-s.length);if(l!==s)return;var p=e.substring(0,e.length-s.length);e=l}else if(s){var d=e.indexOf(s),p=e.substring(0,d);e=e.substring(d)}else if(o[f+1]){var d=e.indexOf(o[f+1]);d===-1&&(d=e.length);var p=e.substring(0,d);e=e.substring(d)}else{if(i.length>f+2){f++,s=i[f+1];continue}var p=e;e=""}break}if(!c[r](p,t,n.strict))return}}return t},this.varNames=a,this.template=e}var i={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},o={"*":!0};return r.prototype={toString:function(){return this.template},fillFromObject:function(e){return this.fill(e)},test:function(e,n){return!!this.fromUri(e,n)}},r})}),de=function(e){return{processOption:function(n,t){return n=t(n),n.url=e,n.uri=new pe(String(e)),n}}},he=function(e){return{processOption:function(n,t){return n=t(n),n.credentials=e||"include",n}}},ve=Object.freeze({body:V,headers:B,method:$,params:se,timeout:fe,mode:le,url:de,credentials:he}),ge=[],be=function(e,n){return A(e)?n=Object.assign({url:e},n):x(e)&&(n=Object.assign(e,n)),Object.keys(n).reduce(function(e,t){return ve[t]?e.concat(ve[t](n[t])):(console.warn("[mfetch] No "+t+" plugins for mfetch!"),e)},[])},ye=function(e){var n=b(),t={url:"/",method:"get",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}};return n.extension(q),n.extension(e),n.extension(ge),n.post("request",n.post("afterOption",n.post("option",n.post("beforeOption",t))))},me=function(e,n){return ye(be(e,n))},je=function(e,n){if(O(e))return function(n){return Promise.resolve(e(n))};var t=be(e,n);return function(e){return ye(t.concat(se(e)))}},Oe=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];ge=ge.concat(e)},we=function(e){ge=ge.concat(L(e))};e.fetch=me,e.resource=je,e.extension=Oe,e.interceptor=we,Object.defineProperty(e,"__esModule",{value:!0})});